generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Dataset {
  id               String        @id @default(uuid())
  originalFilename String
  storedFilePath   String?
  rowsCount        Int           @default(0)
  columns          Json?
  status           DatasetStatus @default(NEW)
  progress         Int           @default(0)
  errorText        String?
  createdAt        DateTime      @default(now())
  rows             DatasetRow[]
}

model DatasetRow {
  id        String  @id @default(uuid())
  datasetId String
  dataset   Dataset @relation(fields: [datasetId], references: [id], onDelete: Cascade)
  data      Json

  @@index([datasetId])
}

enum DatasetStatus {
  NEW
  PROCESSING
  READY
  FAILED
}
